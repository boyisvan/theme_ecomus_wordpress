(function(u){"use strict";var m=m||{};m.init=function(){m.$body=u(document.body),m.$window=u(window),m.$header=u("#site-header");this.topCategories();this.scrollFilterSidebar();this.productsFilterActivated();this.changeCatalogElementsFiltered();this.catalogOrderBy();this.loadMoreProducts()};m.topCategories=function(){if(typeof Swiper==="undefined"){return}var e=u(".catalog-top-categories");var t={observer:true,observeParents:true,loop:false,autoplay:false,watchOverflow:true,spaceBetween:e.data("spacing"),navigation:{nextEl:e.find(".swiper-button-next").get(0),prevEl:e.find(".swiper-button-prev").get(0)},pagination:{el:e.find(".swiper-pagination").get(0),type:"bullets",clickable:true},breakpoints:{0:{slidesPerView:2,slidesPerGroup:2,spaceBetween:15},768:{slidesPerView:3,slidesPerGroup:3,spaceBetween:e.data("spacing")},1200:{slidesPerView:5,slidesPerGroup:1}}};new Swiper(e.get(0),t)};m.scrollFilterSidebar=function(){m.$body.on("ecomus_products_filter_before_send_request",function(){var e=0;if(!u("#ecomus-shop-content").length){return}if(u(".catalog-toolbar").length){e+=u(".catalog-toolbar").outerHeight()}u("html,body").stop().animate({scrollTop:u("#ecomus-shop-content").offset().top-e},"300",function(){})})};m.productsFilterActivated=function(){var a=u(".catalog-toolbar__filters-actived"),n=u(".catalog-toolbar__active-filters"),i=u(".filter-sidebar-panel"),e=i.find(".products-filter__activated-items"),r='<a href="#" class="remove-filtered remove-filtered-all">'+a.data("clear-text")+"</a>";if(e.html()&&e.html().trim()){a.html("");a.removeClass("active");a.prepend(e.html()+r);a.addClass("active");n.addClass("actived")}m.$body.on("ecomus_products_filter_widget_updated",function(e,t){var o=u(t).closest(".filter-sidebar-panel"),i=o.find(".products-filter__activated-items");if(i.html()&&i.html().trim()){a.removeClass("hidden");a.html("");a.removeClass("active");a.prepend(i.html()+r);a.addClass("active");n.addClass("actived")}});a.on("click",".remove-filtered",function(e){var t=u(this).data("value"),o=i.find(".products-filter__activated-items");if(t!=="undefined"){u(this).remove();i.find(".remove-filtered[data-value='"+t+"']").trigger("click")}if(!o.html()||!o.html().trim()){a.html("");a.removeClass("active");n.removeClass("actived")}return false});a.on("click",".remove-filtered-all",function(e){e.preventDefault();a.html("");a.removeClass("active");n.removeClass("actived");i.find(".products-filter__button .reset-button").trigger("click");u("#site-content .woocommerce-notices-wrapper").fadeOut()})};m.changeCatalogElementsFiltered=function(){m.$body.on("ecomus_products_filter_before_send_request",function(e,t){u("#filter-sidebar-panel").find(".panel__button-close").trigger("click")});m.$body.on("ecomus_products_filter_request_success",function(e,t){var o=u(t),i=m.$body.find("#page-header"),a=m.$body.find(".catalog-top-categories"),n=m.$body.find(".catalog-toolbar__result-count"),r=m.$body.find(".ecomus-badges-sale__countdown .ecomus-countdown"),c=m.$body.find(".woocommerce-pagination"),l=m.$body.find(".catalog-sidebar"),s=m.$body.find(".ecomus-toolbar-view"),d=m.$body.find(".catalog-toolbar__active-filters"),f=m.$body.find(".woocommerce-info");if(o.find("#page-header").length){i.replaceWith(o.find("#page-header"))}if(o.find(".catalog-top-categories").length){a.replaceWith(o.find(".catalog-top-categories"));m.topCategories()}if(o.find(".catalog-toolbar__result-count").length){n.replaceWith(o.find(".catalog-toolbar__result-count"))}else{n.find(".count").replaceWith('<span class="count">0</span>')}if(o.find(".ecomus-badges-sale__countdown").length){r.ecomus_countdown()}if(o.find(".woocommerce-pagination").length){c.replaceWith(o.find(".woocommerce-pagination"))}else{c.addClass("hidden")}if(o.find(".catalog-sidebar").length){l.replaceWith(o.find(".catalog-sidebar"))}if(o.find(".ecomus-toolbar-view").length){s.replaceWith(o.find(".ecomus-toolbar-view"))}if(o.find(".em-button-no-products-found").length){f.append(o.find(".em-button-no-products-found"))}d.removeClass("hidden")})};m.catalogOrderBy=function(){var o=u("#mobile-orderby-popover"),i=u(".catalog-toolbar__item .woocommerce-ordering");if(u.fn.select2){i.find("select").select2({width:"auto",minimumResultsForSearch:-1,dropdownCssClass:"products-ordering",dropdownParent:i})}o.find(".mobile-orderby-list").on("click","a",function(e){e.preventDefault();var t=u(this).data("id");o.find(".mobile-orderby-list .selected").removeClass("selected");u(this).addClass("selected");i.find("option:selected").attr("selected",false);i.find("option[value="+t+"]").attr("selected","selected");i.trigger("submit")});var e=i.find("option:selected").val();o.find(".mobile-orderby-list a[data-id="+e+"]").addClass("selected")};m.loadMoreProducts=function(){if(u(".woocommerce-pagination").hasClass("woocommerce-pagination--infinite")){var e=false,t;u(window).on("scroll",function(){if(e){return}e=true;clearTimeout(t);o();setTimeout(function(){e=false},100);t=setTimeout(function(){e=false;o()},200)})}function o(){var t=u(".woocommerce-pagination.woocommerce-pagination--ajax"),o=u(".woocommerce-pagination-button",t);if(m.isVisible(t)&&o.length&&!o.hasClass("loading")){o.addClass("loading");a(o,function(e){o=t.find(".woocommerce-pagination-button")})}}if(u(".woocommerce-pagination").hasClass("woocommerce-pagination--loadmore")){m.$body.on("click",".woocommerce-pagination.woocommerce-pagination--loadmore .woocommerce-pagination-button",function(e){e.preventDefault();i()})}function i(){var t=u(".woocommerce-pagination.woocommerce-pagination--ajax"),o=u(".woocommerce-pagination-button",t);if(m.isVisible(t)&&o.length&&!o.hasClass("loading")){o.addClass("loading");a(o,function(e){o=t.find(".woocommerce-pagination-button")})}}function a(r,c){var l=r.closest(".woocommerce-pagination"),s=r.attr("href");u.get(s,function(e){var t=u("#main",e),o=u("ul.products",t),i=o.children(),a=u(".woocommerce-pagination.woocommerce-pagination--ajax",t);i.addClass("em-fadeinup em-animated");let n=.5;i.each(function(e,t){jQuery(t).css("--em-fadeinup-delay",n+"s");n=n+.1});i.appendTo(l.parent().find("ul.products"));if(a.length){r.replaceWith(u("a",a))}else{l.fadeOut(function(){l.remove()})}if("function"===typeof c){c(e)}m.$body.trigger("ecomus_products_loaded",[i,true]);if(i.hasClass("em-animated")){setTimeout(function(){i.removeClass("em-animated")},10)}r.removeClass("loading");if(ecomusData.shop_nav_ajax_url_change){window.history.pushState(null,"",s)}})}};m.isVisible=function(e){if(e instanceof jQuery){e=e[0]}if(!e){return false}var t=e.getBoundingClientRect();return t.bottom>0&&t.right>0&&t.left<(window.innerWidth||document.documentElement.clientWidth)&&t.top<(window.innerHeight||document.documentElement.clientHeight)};u(function(){m.init()})})(jQuery);